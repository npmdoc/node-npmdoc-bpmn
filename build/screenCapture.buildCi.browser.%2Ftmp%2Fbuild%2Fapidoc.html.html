<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/e2ebridge/bpmn#readme">bpmn (v0.2.2)</a>
</h1>
<h4>BPMN 2.0 execution engine</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn">module bpmn</a><ol>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">bpmn.</span>_initialising</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">boolean <span class="apidocSignatureSpan">bpmn.</span>_initialized</span>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._afterInitialization
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._createCollaboratingProcesses
            <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._createSingleProcess
            <span class="apidocSignatureSpan">(processId, processName, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._initialiseDefinition
            <span class="apidocSignatureSpan">(processDefinition)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addBpmnFilePath
            <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addBpmnXML
            <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandler
            <span class="apidocSignatureSpan">(name, handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandlerFilePath
            <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandlerString
            <span class="apidocSignatureSpan">(name, handlerString)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.createProcess
            <span class="apidocSignatureSpan">(descriptors, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createServer">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.createServer
            <span class="apidocSignatureSpan">(options, restifyOptions)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByName">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByName
            <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByProperty
            <span class="apidocSignatureSpan">(query, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByState">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByState
            <span class="apidocSignatureSpan">(stateName, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.get">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.get
            <span class="apidocSignatureSpan">(processId, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.getDefinitionNames
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.clearCache">
            function <span class="apidocSignatureSpan">bpmn.</span>clearCache
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcesses">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcesses
            <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcessesFromXML
            <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedProcess">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcess
            <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedProcessFromXML">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcessFromXML
            <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.getBPMNDefinitions">
            function <span class="apidocSignatureSpan">bpmn.</span>getBPMNDefinitions
            <span class="apidocSignatureSpan">(bpmnFilePath, cache)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.mapName2HandlerName">
            function <span class="apidocSignatureSpan">bpmn.</span>mapName2HandlerName
            <span class="apidocSignatureSpan">(bpmnName)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_definitionsToInitialize</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_initialiseCallbacks</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_initializationError</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_persistency</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_processCache</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_processDefinitions</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>_processHandlers</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>client</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>debugger</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>find</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>handler</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>history</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>logLevels</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>logger</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>manager</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>process</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>rest</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>state</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.</span>timeouts</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager">module bpmn.ProcessManager</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.ProcessManager">
            function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype">module bpmn.ProcessManager.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_afterInitialization
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createCollaboratingProcesses
            <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createSingleProcess
            <span class="apidocSignatureSpan">(processId, processName, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_initialiseDefinition
            <span class="apidocSignatureSpan">(processDefinition)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnFilePath
            <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnXML
            <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandler
            <span class="apidocSignatureSpan">(name, handler)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerFilePath
            <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerString
            <span class="apidocSignatureSpan">(name, handlerString)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createProcess
            <span class="apidocSignatureSpan">(descriptors, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createServer">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createServer
            <span class="apidocSignatureSpan">(options, restifyOptions)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByName">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByName
            <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByProperty
            <span class="apidocSignatureSpan">(query, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByState">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByState
            <span class="apidocSignatureSpan">(stateName, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.get">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>get
            <span class="apidocSignatureSpan">(processId, callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getDefinitionNames
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype._afterInitialization">module bpmn.ProcessManager.prototype._afterInitialization</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization._afterInitialization">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_afterInitialization
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype._createCollaboratingProcesses">module bpmn.ProcessManager.prototype._createCollaboratingProcesses</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses._createCollaboratingProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createCollaboratingProcesses
            <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype._createSingleProcess">module bpmn.ProcessManager.prototype._createSingleProcess</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess._createSingleProcess">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createSingleProcess
            <span class="apidocSignatureSpan">(processId, processName, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype._getAllProcesses">module bpmn.ProcessManager.prototype._getAllProcesses</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses._getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype._initialiseDefinition">module bpmn.ProcessManager.prototype._initialiseDefinition</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition._initialiseDefinition">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_initialiseDefinition
            <span class="apidocSignatureSpan">(processDefinition)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.addBpmnFilePath">module bpmn.ProcessManager.prototype.addBpmnFilePath</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath.addBpmnFilePath">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnFilePath
            <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.addBpmnXML">module bpmn.ProcessManager.prototype.addBpmnXML</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML.addBpmnXML">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnXML
            <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandler">module bpmn.ProcessManager.prototype.addHandler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler.addHandler">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandler
            <span class="apidocSignatureSpan">(name, handler)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandlerFilePath">module bpmn.ProcessManager.prototype.addHandlerFilePath</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath.addHandlerFilePath">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerFilePath
            <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandlerString">module bpmn.ProcessManager.prototype.addHandlerString</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString.addHandlerString">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerString
            <span class="apidocSignatureSpan">(name, handlerString)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.createProcess">module bpmn.ProcessManager.prototype.createProcess</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess.createProcess">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createProcess
            <span class="apidocSignatureSpan">(descriptors, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.createServer">module bpmn.ProcessManager.prototype.createServer</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.createServer.createServer">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createServer
            <span class="apidocSignatureSpan">(options, restifyOptions)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByName">module bpmn.ProcessManager.prototype.findByName</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByName.findByName">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByName
            <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByProperty">module bpmn.ProcessManager.prototype.findByProperty</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty.findByProperty">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByProperty
            <span class="apidocSignatureSpan">(query, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByState">module bpmn.ProcessManager.prototype.findByState</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.findByState.findByState">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByState
            <span class="apidocSignatureSpan">(stateName, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.get">module bpmn.ProcessManager.prototype.get</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.get.get">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>get
            <span class="apidocSignatureSpan">(processId, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.getAllProcesses">module bpmn.ProcessManager.prototype.getAllProcesses</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses.getAllProcesses">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getAllProcesses
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.ProcessManager.prototype.getDefinitionNames">module bpmn.ProcessManager.prototype.getDefinitionNames</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames.getDefinitionNames">
            function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getDefinitionNames
            <span class="apidocSignatureSpan">(callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.clearCache">module bpmn.clearCache</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.clearCache.clearCache">
            function <span class="apidocSignatureSpan">bpmn.</span>clearCache
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.client">module bpmn.client</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.client.BPMNProcessClient">
            function <span class="apidocSignatureSpan">bpmn.client.</span>BPMNProcessClient
            <span class="apidocSignatureSpan">(bpmnProcess)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.createUnmanagedCollaboratingProcesses">module bpmn.createUnmanagedCollaboratingProcesses</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcesses.createUnmanagedCollaboratingProcesses">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcesses
            <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.createUnmanagedCollaboratingProcessesFromXML">module bpmn.createUnmanagedCollaboratingProcessesFromXML</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML.createUnmanagedCollaboratingProcessesFromXML">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcessesFromXML
            <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.createUnmanagedProcess">module bpmn.createUnmanagedProcess</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedProcess.createUnmanagedProcess">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcess
            <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.createUnmanagedProcessFromXML">module bpmn.createUnmanagedProcessFromXML</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.createUnmanagedProcessFromXML.createUnmanagedProcessFromXML">
            function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcessFromXML
            <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.debugger">module bpmn.debugger</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.debugger.DebuggerInterface">
            function <span class="apidocSignatureSpan">bpmn.debugger.</span>DebuggerInterface
            <span class="apidocSignatureSpan">(url, fileName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.debugger.createDebuggerInterface">
            function <span class="apidocSignatureSpan">bpmn.debugger.</span>createDebuggerInterface
            <span class="apidocSignatureSpan">(node, fileName)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.debugger.isDebuggerElement">
            function <span class="apidocSignatureSpan">bpmn.debugger.</span>isDebuggerElement
            <span class="apidocSignatureSpan">(node)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.find">module bpmn.find</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.find.findByName">
            function <span class="apidocSignatureSpan">bpmn.find.</span>findByName
            <span class="apidocSignatureSpan">(bpmnProcesses, processName, caseSensitive)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.find.findByProperty">
            function <span class="apidocSignatureSpan">bpmn.find.</span>findByProperty
            <span class="apidocSignatureSpan">(bpmnProcesses, query)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.find.findByState">
            function <span class="apidocSignatureSpan">bpmn.find.</span>findByState
            <span class="apidocSignatureSpan">(bpmnProcesses, stateName)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.getBPMNDefinitions">module bpmn.getBPMNDefinitions</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.getBPMNDefinitions.getBPMNDefinitions">
            function <span class="apidocSignatureSpan">bpmn.</span>getBPMNDefinitions
            <span class="apidocSignatureSpan">(bpmnFilePath, cache)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.handler">module bpmn.handler</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.callHandler">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>callHandler
            <span class="apidocSignatureSpan">(name, process, data, handlerDoneCallback)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.getHandlerFileName">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFileName
            <span class="apidocSignatureSpan">(bpmnFilePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.getHandlerFromFile">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromFile
            <span class="apidocSignatureSpan">(bpmnFilePath)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.getHandlerFromProcess">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromProcess
            <span class="apidocSignatureSpan">(name, process)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.getHandlerFromString">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromString
            <span class="apidocSignatureSpan">(moduleString)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.handler.mapName2HandlerName">
            function <span class="apidocSignatureSpan">bpmn.handler.</span>mapName2HandlerName
            <span class="apidocSignatureSpan">(name)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">bpmn.handler.</span>handlerNameSeparator</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.history">module bpmn.history</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.history.BPMNProcessHistory">
            function <span class="apidocSignatureSpan">bpmn.history.</span>BPMNProcessHistory
            <span class="apidocSignatureSpan">(history)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.history.HistoryEntry">
            function <span class="apidocSignatureSpan">bpmn.history.</span>HistoryEntry
            <span class="apidocSignatureSpan">(name, type, begin, end)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.history.setDummyTimestampFunction">
            function <span class="apidocSignatureSpan">bpmn.history.</span>setDummyTimestampFunction
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.history.setTimestampFunction">
            function <span class="apidocSignatureSpan">bpmn.history.</span>setTimestampFunction
            <span class="apidocSignatureSpan">(getTimestampFunction)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.logger">module bpmn.logger</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.logger.Logger">
            function <span class="apidocSignatureSpan">bpmn.logger.</span>Logger
            <span class="apidocSignatureSpan">(process, options)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">bpmn.logger.</span>logLevels</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.manager">module bpmn.manager</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.manager.ProcessManager">
            function <span class="apidocSignatureSpan">bpmn.manager.</span>ProcessManager
            <span class="apidocSignatureSpan">(options)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.mapName2HandlerName">module bpmn.mapName2HandlerName</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.mapName2HandlerName.mapName2HandlerName">
            function <span class="apidocSignatureSpan">bpmn.</span>mapName2HandlerName
            <span class="apidocSignatureSpan">(bpmnName)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.process">module bpmn.process</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.process.createBPMNProcess">
            function <span class="apidocSignatureSpan">bpmn.process.</span>createBPMNProcess
            <span class="apidocSignatureSpan">(id, processDefinition, eventHandler, persistency, parentProcess, parentToken, parentHistoryEntry, callback)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.rest">module bpmn.rest</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.rest.clearReceivedMessageIds">
            function <span class="apidocSignatureSpan">bpmn.rest.</span>clearReceivedMessageIds
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.rest.createServer">
            function <span class="apidocSignatureSpan">bpmn.rest.</span>createServer
            <span class="apidocSignatureSpan">(manager, options, restifyOptions)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.state">module bpmn.state</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.state.BPMNProcessState">
            function <span class="apidocSignatureSpan">bpmn.state.</span>BPMNProcessState
            <span class="apidocSignatureSpan">(state)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.state.CallActivityToken">
            function <span class="apidocSignatureSpan">bpmn.state.</span>CallActivityToken
            <span class="apidocSignatureSpan">(flowObjectName, owningProcessId, calledProcessId)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.state.Token">
            function <span class="apidocSignatureSpan">bpmn.state.</span>Token
            <span class="apidocSignatureSpan">(flowObjectName, owningProcessId)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.bpmn.timeouts">module bpmn.timeouts</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.bpmn.timeouts.BPMNPendingTimerEvents">
            function <span class="apidocSignatureSpan">bpmn.timeouts.</span>BPMNPendingTimerEvents
            <span class="apidocSignatureSpan">(bpmnProcess)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn" id="apidoc.module.bpmn">module bpmn</a></h1>






    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager" id="apidoc.element.bpmn.ProcessManager">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager = function (options){
    var self = this;

    options = options || {};

    self._processCache = {};

    self._initialized = true;
    self._initialising = false;
    self._initializationError = null;
    self._definitionsToInitialize = [];
    self._initialiseCallbacks = [];

    self._persistency = null;
    if (options.persistencyOptions) {
        self._persistency =  new Persistency(options.persistencyOptions);
        self._doneLoadingHandler = options.persistencyOptions.doneLoading;
        self._doneSavingHandler = options.persistencyOptions.doneSaving;
    }

    self._processHandlers = {};
    self._processDefinitions = {};


    if(!options.handlerFilePath){
        options.handlerFilePath = [];
    }

    if(!util.isArray(options.handlerFilePath)){
        options.handlerFilePath = [options.handlerFilePath];
    }

    options.handlerFilePath.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.filePath){
            throw new Error("handlerFilePath needs a name and a filePath");
        }

        self.addHandlerFilePath(handlerDescriptor.name, handlerDescriptor.filePath);
    });


    if(!options.handler){
        options.handler = [];
    }

    if(!util.isArray(options.handler)){
        options.handler = [options.handler];
    }

    options.handler.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.module){
            throw new Error("handler needs a name and a module");
        }

        self.addHandler(handlerDescriptor.name, handlerDescriptor.module);
    });

    if(!options.handlerString){
        options.handlerString = [];
    }

    if(!util.isArray(options.handlerString)){
        options.handlerString = [options.handlerString];
    }

    options.handlerString.forEach(function(handlerString){
        if(!handlerString.name || !handlerString.string){
            throw new Error("handlerString needs a name and a string");
        }

        self.addHandlerString(handlerString.name, handlerString.string);
    });


    if(!options.bpmnFilePath){
        options.bpmnFilePath = [];
    }

    if(!util.isArray(options.bpmnFilePath)){
        options.bpmnFilePath = [options.bpmnFilePath];
    }

    options.bpmnFilePath.forEach(function(filePath){
        self.addBpmnFilePath(filePath);
    });


    if(!options.bpmnXML){
        options.bpmnXML = [];
    }

    if(!util.isArray(options.bpmnXML)){
        options.bpmnXML = [options.bpmnXML];
    }

    options.bpmnXML.forEach(function(bpmnXML){
        if(!bpmnXML.name || !bpmnXML.xml){
            throw new Error("bpmnXML needs a name and a xml");
        }

        self.addBpmnXML(bpmnXML.xml, bpmnXML.name);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	bpmnProcess.removeLogTransport(winston.transports.File);

Managing processes
==================

Process managers are used to create multiple processes using the same definitions and find them back later.

    var manager = new bpmn.<span class="apidocCodeKeywordSpan">ProcessManager</span>();

    manager.addBpmnFilePath("path/to/myProcess.bpmn");

    manager.createProcess("myId", function(err, myProcess){

// we start the process
myProcess.triggerEvent("MyStart");
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization" id="apidoc.element.bpmn.ProcessManager.prototype._afterInitialization">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._afterInitialization
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype._afterInitialization = function (callback){
    if(this._initialized){
        return callback(this._initializationError);
    }

    this._initialiseCallbacks.push(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._createCollaboratingProcesses
        <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype._createCollaboratingProcesses = function (processDescriptors, callback) {
    var self = this;
    var processes = {};

    async.eachSeries(processDescriptors, function(processDescriptor, done) {

        self._createSingleProcess(processDescriptor.id, processDescriptor.name, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDescriptor.name] = bpmnProcess;
            done();
        });

    }, function(err){
        var results = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            results.push(bpmnProcess);
        });

        callback(err, results);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess" id="apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._createSingleProcess
        <span class="apidocSignatureSpan">(processId, processName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype._createSingleProcess = function (processId, processName, callback){
    createBPMNProcess(processId, this._processDefinitions[processName], this._processHandlers[processName], this._persistency, function
(err, bpmnProcess){
        callback(err, bpmnProcess);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype._getAllProcesses = function (callback) {
    var self = this;
    var allProcessIds = Object.keys(this._processCache);

    if(!callback){
        return;
    }

    callback(null, allProcessIds.map(function(loadedProcessId) {
        return self._processCache[loadedProcessId];
    }));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition" id="apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype._initialiseDefinition
        <span class="apidocSignatureSpan">(processDefinition)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype._initialiseDefinition = function (processDefinition){
    var self = this;

    self._initializationError = null;
    self._initialized = false;

    self._definitionsToInitialize.push(processDefinition);

    if(!self._initialising){    // if already initialising we don't call next, the definition will be initialised after current
one.
        next();
    }

    /**
     * Called after all initializations are done.
     * @param err
     */
    function execCallbacks(err){
        self._definitionsToInitialize = [];

        self._initializationError = err;
        self._initialized = true;
        self._initialising = false;

        self._initialiseCallbacks.forEach(function(callback){   // call all waiting callbacks
            callback(err);
        });
    }

    function next(){
        self._initialising = true;

        if(self._definitionsToInitialize.length === 0){     // if all definitions have been initialized
            return execCallbacks();
        }

        var currentDefinition = self._definitionsToInitialize.pop();    // get the next definition

        if(self._processDefinitions[currentDefinition.name] ||      // if the definition already exist it means the processes were
 already loaded
                !self._persistency){                                // if there is no persistency nothing needs to be loaded

            self._processDefinitions[currentDefinition.name] = currentDefinition;   // we simply add or replace the definition
            return next();
        }


        self._persistency.loadAll(currentDefinition.name, function(err, documents){     // load all saved document

            if(err){
                execCallbacks(err);
                return;
            }

            self._processDefinitions[currentDefinition.name] = currentDefinition;

            async.each(documents, function(document, done){                                                         // for each
persisted document found

                self._createSingleProcess(document.processId, currentDefinition.name, function(err, bpmnProcess){       // create
 the process
                    if(err){
                        return done(err);
                    }

                    if(self._processCache[bpmnProcess.getProcessId()]){                  // check if id already used
                        return done(new Error('duplicated id in persisted data'));
                    }

                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    done();
                });

            }, function(err){
                if(err){
                    return execCallbacks(err);
                }

                next();
            });

        });

    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addBpmnFilePath
        <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.addBpmnFilePath = function (bpmnFilePath, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromFile(processHandler);
    }

    if(!processHandler){
        try{
            processHandler = handlers.getHandlerFromFile(bpmnFilePath);
            processHandler.doneLoadingHandler = self._doneLoadingHandler;
            processHandler.doneSavingHandler = self._doneSavingHandler;
        }catch(err){}
    }

    processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addBpmnXML
        <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.addBpmnXML = function (bpmnXml, processName, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromString(processHandler);
    }

    processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXml, processName);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler" id="apidoc.element.bpmn.ProcessManager.prototype.addHandler">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandler
        <span class="apidocSignatureSpan">(name, handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.addHandler = function (name, handler){
    this._processHandlers[name] = handler;
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandlerFilePath
        <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.addHandlerFilePath = function (name, handlerFilePath){
    this._processHandlers[name] = handlers.getHandlerFromFile(handlerFilePath);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerString">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.addHandlerString
        <span class="apidocSignatureSpan">(name, handlerString)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.addHandlerString = function (name, handlerString){
    this._processHandlers[name] = handlers.getHandlerFromString(handlerString);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess" id="apidoc.element.bpmn.ProcessManager.prototype.createProcess">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.createProcess
        <span class="apidocSignatureSpan">(descriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.createProcess = function (descriptors, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(err){
            return callback(err);
        }

        if (typeof descriptors === 'string' &amp;&amp; Object.keys(self._processDefinitions).length !== 1) {
            return callback(new Error("The manager contains more than one process definition. " +
                "processId have to be an Array.&lt;{name: String, id: String}&gt;} "));
        }

        if(util.isArray(descriptors)) {
            descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                if(self._processCache[descriptor.id]){
                    err = new Error('id already used');
                }
            });
            if(err){
                return callback(err);
            }

            self._createCollaboratingProcesses(descriptors, function(err, bpmnProcesses){
                if(err){
                    return callback(err);
                }

                descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                    if(self._processCache[descriptor.id]){          // again because a process could have been created in between
                        err = new Error('id already used');
                    }
                });
                if(err){
                    return callback(err);
                }

                callback(null, bpmnProcesses.map(function(bpmnProcess){
                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    return bpmnProcess.processClient;
                }));
            });

            return;
        }

        if(typeof descriptors === 'string') {
            descriptors = {
                id: descriptors,
                name: Object.keys(self._processDefinitions)[0]
            };
        }

        if(self._processCache[descriptors.id]){                                        // check if id already used
            return callback(new Error('id already used'));
        }

        self._createSingleProcess(descriptors.id, descriptors.name, function(err, bpmnProcess){
            if(err){
                return callback(err);
            }

            if(self._processCache[descriptors.id]){                                      // check if id already used
                return callback(new Error('id already used'));                      // again because a process could have been created
 in between
            }

            self._processCache[descriptors.id] = bpmnProcess;
            callback(null, bpmnProcess.processClient);
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createServer" id="apidoc.element.bpmn.ProcessManager.prototype.createServer">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.createServer
        <span class="apidocSignatureSpan">(options, restifyOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.createServer = function (options, restifyOptions){
    return rest.createServer(this,  options, restifyOptions);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByName" id="apidoc.element.bpmn.ProcessManager.prototype.findByName">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByName
        <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.findByName = function (processName, caseSensitive, callback) {
    var self = this;

    if(typeof caseSensitive === 'function'){
        callback = caseSensitive;
        caseSensitive = true;
    }

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByName(bpmnProcesses, processName, caseSensitive));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty" id="apidoc.element.bpmn.ProcessManager.prototype.findByProperty">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByProperty
        <span class="apidocSignatureSpan">(query, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.findByProperty = function (query, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByProperty(bpmnProcesses, query));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByState" id="apidoc.element.bpmn.ProcessManager.prototype.findByState">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.findByState
        <span class="apidocSignatureSpan">(stateName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.findByState = function (stateName, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByState(bpmnProcesses, stateName));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.get" id="apidoc.element.bpmn.ProcessManager.prototype.get">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.get
        <span class="apidocSignatureSpan">(processId, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function get(processId, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(callback){
            callback(err, self._processCache[processId]);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.getAllProcesses = function (callback) {
    var self = this;

    if(!callback){
        return;
    }


    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self._getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, bpmnProcesses.map(function (bpmnProcess) {
                return bpmnProcess.processClient;
            }));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames" id="apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager.prototype.getDefinitionNames
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager.prototype.getDefinitionNames = function (callback){
    var self = this;

    this._afterInitialization(function(err){
        callback(err, Object.keys(self._processDefinitions));
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.clearCache" id="apidoc.element.bpmn.clearCache">
        function <span class="apidocSignatureSpan">bpmn.</span>clearCache
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearCache = function () {
    definitions.clearCache();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcesses" id="apidoc.element.bpmn.createUnmanagedCollaboratingProcesses">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcesses
        <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedCollaboratingProcesses = function (bpmnFilePath, callback) {
    var processes = {};
    var processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);
    var handler = handlers.getHandlerFromFile(bpmnFilePath);

    async.eachSeries(processDefinitions, function(processDefinition, done) {
        bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDefinition.name] = bpmnProcess;
            done();
        });
    }, function(err){
        var clients = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            clients.push(bpmnProcess.processClient);
        });

        callback(err, clients);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
BPMN also supports collaborating processes as depicted below.

![](https://raw.githubusercontent.com/e2ebridge/bpmn/master/examples/processes/collaboration.png)

These processes must be created together:

	// create collaborating processes
bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedCollaboratingProcesses</span>("my/collaboration/example.bpmn",
function(err, collaboratingProcesses){

    // start the second process
    var secondProcess = collaboratingProcesses[1];
    secondProcess.triggerEvent("Start Event 2");

});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML" id="apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcessesFromXML
        <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedCollaboratingProcessesFromXML = function (bpmnXML, handler, callback) {
    var processes = {};
    var processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXML);

    if(typeof handler === 'string'){
        handler = handlers.getHandlerFromString(handler);
    }

    async.eachSeries(processDefinitions, function(processDefinition, done) {
        bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDefinition.name] = bpmnProcess;
            done();
        });
    }, function(err){
        var clients = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            clients.push(bpmnProcess.processClient);
        });

        callback(err, clients);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedProcess" id="apidoc.element.bpmn.createUnmanagedProcess">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcess
        <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedProcess = function (bpmnFilePath, callback) {
    var processDefinition, error;
    var processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);
    var handler = handlers.getHandlerFromFile(bpmnFilePath);

    if (processDefinitions.length === 1) {
        processDefinition = processDefinitions[0];
    } else {
        error = new Error("The BPMN file '" + bpmnFilePath + "'. contains more than one process definition. Use 'createCollaboratingProcesses
' instead of 'createProcess'");
        if(!callback) {
            throw error;
        } else {
            callback(error);
        }
    }

    bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
        if(!callback){
            return;
        }

        callback(err, bpmnProcess.processClient);
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
![](https://raw.githubusercontent.com/e2ebridge/bpmn/master/examples/processes/task.png)

then this process can be created by


	var bpmn = require("bpmn");
	// We assume there is a myProcess.js besides myProcess.bpmn that contains the handlers
	bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedProcess</span>("path/to/myProcess.bpmn", function(err, myProcess
){

        // we start the process
        myProcess.triggerEvent("MyStart");

	});

The handler file looks like:
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedProcessFromXML" id="apidoc.element.bpmn.createUnmanagedProcessFromXML">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcessFromXML
        <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedProcessFromXML = function (bpmnXML, handler, callback) {
    var processDefinition, error;
    var processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXML, "Standalone");

    if (processDefinitions.length === 1) {
        processDefinition = processDefinitions[0];
    } else {
        error = new Error("The BPMN XML contains more than one process definition. Use 'createCollaboratingProcesses' instead of
 'createProcess'");
        return callback(error);
    }

    if(typeof handler === 'string') {
        handler = handlers.getHandlerFromString(handler);
    }

    bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
        callback(err, bpmnProcess.processClient);
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    	// Called after MyEnd has been reached
    	done(data);
	};

Processes can also be created from an xml string instead of file. In this case the handler can be an object or a javascript string
 that would be parsed.


	bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedProcessFromXML</span>("&lt;definitions ... &lt;/definitions&gt;
;", "exports.MyStart = ...", function(err, myProcess){

        // we start the process
        myProcess.triggerEvent("MyStart");

	});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.getBPMNDefinitions" id="apidoc.element.bpmn.getBPMNDefinitions">
        function <span class="apidocSignatureSpan">bpmn.</span>getBPMNDefinitions
        <span class="apidocSignatureSpan">(bpmnFilePath, cache)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getBPMNDefinitions = function (bpmnFilePath, cache) {
    var bpmnDefinitions = null;
    if (cache) {
        bpmnDefinitions = definitions.getCachedBPMNDefinitions(bpmnFilePath);
    } else {
        bpmnDefinitions = definitions.getBPMNDefinitions(bpmnFilePath);
    }
    return bpmnDefinitions;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.mapName2HandlerName" id="apidoc.element.bpmn.mapName2HandlerName">
        function <span class="apidocSignatureSpan">bpmn.</span>mapName2HandlerName
        <span class="apidocSignatureSpan">(bpmnName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mapName2HandlerName = function (bpmnName) {
    return handlers.mapName2HandlerName(bpmnName);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @private
 */
BPMNProcess.prototype._registerActivityEndEvents = function() {
    var self = this;

    self.on(ACTIVITY_END_EVENT, function(activityName, data) {
var currentToken, owningProcessId, currentProcess, currentFlowObject, activityEndHandlerIsDone;
var handlerName = handler.<span class="apidocCodeKeywordSpan">mapName2HandlerName</span>(activityName) + activityEndHandlerPostfix
;
var trx = self.currentTrx = null;

if(self.transactionLogger){
    trx = self.currentTrx = self.transactionLogger.startTransaction(self.processDefinition.name, 'PSTATE', 'TRANSITION
', null, activityName+'Done');
}

if (self.state.hasTokens(activityName)) {
...</pre></li>
    </ul>










































</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager" id="apidoc.module.bpmn.ProcessManager">module bpmn.ProcessManager</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.ProcessManager" id="apidoc.element.bpmn.ProcessManager.ProcessManager">
        function <span class="apidocSignatureSpan">bpmn.</span>ProcessManager
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager = function (options){
    var self = this;

    options = options || {};

    self._processCache = {};

    self._initialized = true;
    self._initialising = false;
    self._initializationError = null;
    self._definitionsToInitialize = [];
    self._initialiseCallbacks = [];

    self._persistency = null;
    if (options.persistencyOptions) {
        self._persistency =  new Persistency(options.persistencyOptions);
        self._doneLoadingHandler = options.persistencyOptions.doneLoading;
        self._doneSavingHandler = options.persistencyOptions.doneSaving;
    }

    self._processHandlers = {};
    self._processDefinitions = {};


    if(!options.handlerFilePath){
        options.handlerFilePath = [];
    }

    if(!util.isArray(options.handlerFilePath)){
        options.handlerFilePath = [options.handlerFilePath];
    }

    options.handlerFilePath.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.filePath){
            throw new Error("handlerFilePath needs a name and a filePath");
        }

        self.addHandlerFilePath(handlerDescriptor.name, handlerDescriptor.filePath);
    });


    if(!options.handler){
        options.handler = [];
    }

    if(!util.isArray(options.handler)){
        options.handler = [options.handler];
    }

    options.handler.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.module){
            throw new Error("handler needs a name and a module");
        }

        self.addHandler(handlerDescriptor.name, handlerDescriptor.module);
    });

    if(!options.handlerString){
        options.handlerString = [];
    }

    if(!util.isArray(options.handlerString)){
        options.handlerString = [options.handlerString];
    }

    options.handlerString.forEach(function(handlerString){
        if(!handlerString.name || !handlerString.string){
            throw new Error("handlerString needs a name and a string");
        }

        self.addHandlerString(handlerString.name, handlerString.string);
    });


    if(!options.bpmnFilePath){
        options.bpmnFilePath = [];
    }

    if(!util.isArray(options.bpmnFilePath)){
        options.bpmnFilePath = [options.bpmnFilePath];
    }

    options.bpmnFilePath.forEach(function(filePath){
        self.addBpmnFilePath(filePath);
    });


    if(!options.bpmnXML){
        options.bpmnXML = [];
    }

    if(!util.isArray(options.bpmnXML)){
        options.bpmnXML = [options.bpmnXML];
    }

    options.bpmnXML.forEach(function(bpmnXML){
        if(!bpmnXML.name || !bpmnXML.xml){
            throw new Error("bpmnXML needs a name and a xml");
        }

        self.addBpmnXML(bpmnXML.xml, bpmnXML.name);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	bpmnProcess.removeLogTransport(winston.transports.File);

Managing processes
==================

Process managers are used to create multiple processes using the same definitions and find them back later.

    var manager = new bpmn.<span class="apidocCodeKeywordSpan">ProcessManager</span>();

    manager.addBpmnFilePath("path/to/myProcess.bpmn");

    manager.createProcess("myId", function(err, myProcess){

// we start the process
myProcess.triggerEvent("MyStart");
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype" id="apidoc.module.bpmn.ProcessManager.prototype">module bpmn.ProcessManager.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization" id="apidoc.element.bpmn.ProcessManager.prototype._afterInitialization">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_afterInitialization
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_afterInitialization = function (callback){
    if(this._initialized){
        return callback(this._initializationError);
    }

    this._initialiseCallbacks.push(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
 * @param {String} processId
 * @param {Function} callback
 */
ProcessManager.prototype.get = function get(processId, callback) {
    var self = this;

    this.<span class="apidocCodeKeywordSpan">_afterInitialization</span>(function(err){
        if(callback){
            callback(err, self._processCache[processId]);
        }
    });
};

/**
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createCollaboratingProcesses
        <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createCollaboratingProcesses = function (processDescriptors, callback) {
    var self = this;
    var processes = {};

    async.eachSeries(processDescriptors, function(processDescriptor, done) {

        self._createSingleProcess(processDescriptor.id, processDescriptor.name, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDescriptor.name] = bpmnProcess;
            done();
        });

    }, function(err){
        var results = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            results.push(bpmnProcess);
        });

        callback(err, results);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    err = new Error('id already used');
}
            });
            if(err){
return callback(err);
            }

            self.<span class="apidocCodeKeywordSpan">_createCollaboratingProcesses</span>(descriptors, function(err, bpmnProcesses
){
if(err){
    return callback(err);
}

descriptors.forEach(function(descriptor){             // check if one of the ids is already used
    if(self._processCache[descriptor.id]){          // again because a process could have been created in between
        err = new Error('id already used');
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess" id="apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createSingleProcess
        <span class="apidocSignatureSpan">(processId, processName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createSingleProcess = function (processId, processName, callback){
    createBPMNProcess(processId, this._processDefinitions[processName], this._processHandlers[processName], this._persistency, function
(err, bpmnProcess){
        callback(err, bpmnProcess);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                return;
            }

            self._processDefinitions[currentDefinition.name] = currentDefinition;

            async.each(documents, function(document, done){                                                         // for each
persisted document found

                self.<span class="apidocCodeKeywordSpan">_createSingleProcess</span>(document.processId, currentDefinition.name,
function(err, bpmnProcess){       // create the process
if(err){
    return done(err);
}

if(self._processCache[bpmnProcess.getProcessId()]){                  // check if id already used
    return done(new Error('duplicated id in persisted data'));
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getAllProcesses = function (callback) {
    var self = this;
    var allProcessIds = Object.keys(this._processCache);

    if(!callback){
        return;
    }

    callback(null, allProcessIds.map(function(loadedProcessId) {
        return self._processCache[loadedProcessId];
    }));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


    this._afterInitialization(function(err){
        if (err) {
return callback(err);
        }

        self.<span class="apidocCodeKeywordSpan">_getAllProcesses</span>(function (err, bpmnProcesses) {
if (err) {
    return callback(err);
}

callback(null, bpmnProcesses.map(function (bpmnProcess) {
    return bpmnProcess.processClient;
}));
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition" id="apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_initialiseDefinition
        <span class="apidocSignatureSpan">(processDefinition)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initialiseDefinition = function (processDefinition){
    var self = this;

    self._initializationError = null;
    self._initialized = false;

    self._definitionsToInitialize.push(processDefinition);

    if(!self._initialising){    // if already initialising we don't call next, the definition will be initialised after current
one.
        next();
    }

    /**
     * Called after all initializations are done.
     * @param err
     */
    function execCallbacks(err){
        self._definitionsToInitialize = [];

        self._initializationError = err;
        self._initialized = true;
        self._initialising = false;

        self._initialiseCallbacks.forEach(function(callback){   // call all waiting callbacks
            callback(err);
        });
    }

    function next(){
        self._initialising = true;

        if(self._definitionsToInitialize.length === 0){     // if all definitions have been initialized
            return execCallbacks();
        }

        var currentDefinition = self._definitionsToInitialize.pop();    // get the next definition

        if(self._processDefinitions[currentDefinition.name] ||      // if the definition already exist it means the processes were
 already loaded
                !self._persistency){                                // if there is no persistency nothing needs to be loaded

            self._processDefinitions[currentDefinition.name] = currentDefinition;   // we simply add or replace the definition
            return next();
        }


        self._persistency.loadAll(currentDefinition.name, function(err, documents){     // load all saved document

            if(err){
                execCallbacks(err);
                return;
            }

            self._processDefinitions[currentDefinition.name] = currentDefinition;

            async.each(documents, function(document, done){                                                         // for each
persisted document found

                self._createSingleProcess(document.processId, currentDefinition.name, function(err, bpmnProcess){       // create
 the process
                    if(err){
                        return done(err);
                    }

                    if(self._processCache[bpmnProcess.getProcessId()]){                  // check if id already used
                        return done(new Error('duplicated id in persisted data'));
                    }

                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    done();
                });

            }, function(err){
                if(err){
                    return execCallbacks(err);
                }

                next();
            });

        });

    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

       if(processHandler) {
           self._processHandlers[processDefinition.name] = processHandler;
       } else if(!self._processHandlers[processDefinition.name]){
           throw new Error('No process handler defined for process "'+processDefinition.name+'". The process
 handler must be defined before the process or with the process.');
       }

       self.<span class="apidocCodeKeywordSpan">_initialiseDefinition</span>(processDefinition);
   });
};

/**
* Add a bpmn XML to the manager.
* All process definition found in this file will be initialized and replace the old ones if exists.
* A process handler object or file path can be passed. If none passed the same file path as the bpmn is used or the existing handler
.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnFilePath
        <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addBpmnFilePath = function (bpmnFilePath, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromFile(processHandler);
    }

    if(!processHandler){
        try{
            processHandler = handlers.getHandlerFromFile(bpmnFilePath);
            processHandler.doneLoadingHandler = self._doneLoadingHandler;
            processHandler.doneSavingHandler = self._doneSavingHandler;
        }catch(err){}
    }

    processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Managing processes
==================

Process managers are used to create multiple processes using the same definitions and find them back later.

var manager = new bpmn.ProcessManager();

manager.<span class="apidocCodeKeywordSpan">addBpmnFilePath</span>("path/to/myProcess.bpmn");

manager.createProcess("myId", function(err, myProcess){

    // we start the process
    myProcess.triggerEvent("MyStart");

});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnXML
        <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addBpmnXML = function (bpmnXml, processName, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromString(processHandler);
    }

    processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXml, processName);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   }

   options.bpmnXML.forEach(function(bpmnXML){
       if(!bpmnXML.name || !bpmnXML.xml){
           throw new Error("bpmnXML needs a name and a xml");
       }

       self.<span class="apidocCodeKeywordSpan">addBpmnXML</span>(bpmnXML.xml, bpmnXML.name);
   });
};

/**
* Initialise a new definition by loading all persisted process.
* All other function that need the initialise state will wait until initialization is done.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler" id="apidoc.element.bpmn.ProcessManager.prototype.addHandler">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandler
        <span class="apidocSignatureSpan">(name, handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandler = function (name, handler){
    this._processHandlers[name] = handler;
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

options.handler.forEach(function(handlerDescriptor){
    if(!handlerDescriptor.name || !handlerDescriptor.module){
        throw new Error("handler needs a name and a module");
    }

    self.<span class="apidocCodeKeywordSpan">addHandler</span>(handlerDescriptor.name, handlerDescriptor.module);
});

if(!options.handlerString){
    options.handlerString = [];
}

if(!util.isArray(options.handlerString)){
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerFilePath
        <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandlerFilePath = function (name, handlerFilePath){
    this._processHandlers[name] = handlers.getHandlerFromFile(handlerFilePath);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    var manager = new bpmn.ProcessManager({
        bpmnFilePath: "path/to/myProcess.bpmn"
    });



ProcessManager.<span class="apidocCodeKeywordSpan">addHandlerFilePath</span>(name, handlerFilePath)

- **name**: The name of the process definition for which the handler will be used.
- **handlerFilePath**: Path to the javascript file defining the handler module.

ProcessManager.addHandlerString = function(name, handlerString)

- **name**: The name of the process definition for which the handler will be used.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerString">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerString
        <span class="apidocSignatureSpan">(name, handlerString)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandlerString = function (name, handlerString){
    this._processHandlers[name] = handlers.getHandlerFromString(handlerString);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

options.handlerString.forEach(function(handlerString){
    if(!handlerString.name || !handlerString.string){
        throw new Error("handlerString needs a name and a string");
    }

    self.<span class="apidocCodeKeywordSpan">addHandlerString</span>(handlerString.name, handlerString.string);
});


if(!options.bpmnFilePath){
    options.bpmnFilePath = [];
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess" id="apidoc.element.bpmn.ProcessManager.prototype.createProcess">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createProcess
        <span class="apidocSignatureSpan">(descriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createProcess = function (descriptors, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(err){
            return callback(err);
        }

        if (typeof descriptors === 'string' &amp;&amp; Object.keys(self._processDefinitions).length !== 1) {
            return callback(new Error("The manager contains more than one process definition. " +
                "processId have to be an Array.&lt;{name: String, id: String}&gt;} "));
        }

        if(util.isArray(descriptors)) {
            descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                if(self._processCache[descriptor.id]){
                    err = new Error('id already used');
                }
            });
            if(err){
                return callback(err);
            }

            self._createCollaboratingProcesses(descriptors, function(err, bpmnProcesses){
                if(err){
                    return callback(err);
                }

                descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                    if(self._processCache[descriptor.id]){          // again because a process could have been created in between
                        err = new Error('id already used');
                    }
                });
                if(err){
                    return callback(err);
                }

                callback(null, bpmnProcesses.map(function(bpmnProcess){
                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    return bpmnProcess.processClient;
                }));
            });

            return;
        }

        if(typeof descriptors === 'string') {
            descriptors = {
                id: descriptors,
                name: Object.keys(self._processDefinitions)[0]
            };
        }

        if(self._processCache[descriptors.id]){                                        // check if id already used
            return callback(new Error('id already used'));
        }

        self._createSingleProcess(descriptors.id, descriptors.name, function(err, bpmnProcess){
            if(err){
                return callback(err);
            }

            if(self._processCache[descriptors.id]){                                      // check if id already used
                return callback(new Error('id already used'));                      // again because a process could have been created
 in between
            }

            self._processCache[descriptors.id] = bpmnProcess;
            callback(null, bpmnProcess.processClient);
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Process managers are used to create multiple processes using the same definitions and find them back later.

    var manager = new bpmn.ProcessManager();

    manager.addBpmnFilePath("path/to/myProcess.bpmn");

    manager.<span class="apidocCodeKeywordSpan">createProcess</span>("myId", function(err, myProcess){

        // we start the process
        myProcess.triggerEvent("MyStart");

    });

If the process id is already used an error is returned.
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createServer" id="apidoc.element.bpmn.ProcessManager.prototype.createServer">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createServer
        <span class="apidocSignatureSpan">(options, restifyOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createServer = function (options, restifyOptions){
    return rest.createServer(this,  options, restifyOptions);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Server
------

The above API can also be called by REST HTTP calls. To do this, you have first to instantiate a server from ta manager. For example
:

	// Returns a restify server.
	var server = manager.<span class="apidocCodeKeywordSpan">createServer</span>();
	server.listen(9009, function() {
    	console.log('%s listening at %s', server.name, server.url);
	});

The server is a node restify server. So all features of this package can be used.
The full signature of `createProcess`  is
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByName" id="apidoc.element.bpmn.ProcessManager.prototype.findByName">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByName
        <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByName = function (processName, caseSensitive, callback) {
    var self = this;

    if(typeof caseSensitive === 'function'){
        callback = caseSensitive;
        caseSensitive = true;
    }

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByName(bpmnProcesses, processName, caseSensitive));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
        ...
    });

	// returns all processes using this definition
	bpmn.<span class="apidocCodeKeywordSpan">findByName</span>(definitionName, function(err, processes){
        ...
    });


Persistency
-----------
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty" id="apidoc.element.bpmn.ProcessManager.prototype.findByProperty">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByProperty
        <span class="apidocSignatureSpan">(query, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByProperty = function (query, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByProperty(bpmnProcesses, query));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes
bpmn.getAllProcesses(function(err, processes){
    ...
});

	// returns all processes having the property names
	bpmn.<span class="apidocCodeKeywordSpan">findByProperty</span>({propName1: propValue1, propName2: propValue2, ...}, function(err
, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
    ...
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByState" id="apidoc.element.bpmn.ProcessManager.prototype.findByState">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByState
        <span class="apidocSignatureSpan">(stateName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByState = function (stateName, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByState(bpmnProcesses, stateName));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes having the property names
	bpmn.findByProperty({propName1: propValue1, propName2: propValue2, ...}, function(err, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.<span class="apidocCodeKeywordSpan">findByState</span>(stateName, function(err, processes){
    ...
});

	// returns all processes using this definition
	bpmn.findByName(definitionName, function(err, processes){
    ...
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.get" id="apidoc.element.bpmn.ProcessManager.prototype.get">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>get
        <span class="apidocSignatureSpan">(processId, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function get(processId, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(callback){
            callback(err, self._processCache[processId]);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Finding processes
-----------------

Existing processes in a manager can be retrived using these functions:

	// returns the process with the corresponding id
	bpmn.<span class="apidocCodeKeywordSpan">get</span>(processId, function(err, process){
    ...
	});

	// returns all processes
bpmn.getAllProcesses(function(err, processes){
    ...
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAllProcesses = function (callback) {
    var self = this;

    if(!callback){
        return;
    }


    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self._getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, bpmnProcesses.map(function (bpmnProcess) {
                return bpmnProcess.processClient;
            }));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns the process with the corresponding id
	bpmn.get(processId, function(err, process){
    ...
	});

	// returns all processes
bpmn.<span class="apidocCodeKeywordSpan">getAllProcesses</span>(function(err, processes){
    ...
});

	// returns all processes having the property names
	bpmn.findByProperty({propName1: propValue1, propName2: propValue2, ...}, function(err, processes){
    ...
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames" id="apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getDefinitionNames
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDefinitionNames = function (callback){
    var self = this;

    this._afterInitialization(function(err){
        callback(err, Object.keys(self._processDefinitions));
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {ProcessManager} manager
 * @param {String} name
 * @param {Function} callback
 * @returns {*}
 */
function getNameWithCase(manager, name, callback){

    manager.<span class="apidocCodeKeywordSpan">getDefinitionNames</span>(function(err, names){
if(err){
    return callback(err);
}

var ret = null;

names.forEach(function(nameWithCase){
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype._afterInitialization" id="apidoc.module.bpmn.ProcessManager.prototype._afterInitialization">module bpmn.ProcessManager.prototype._afterInitialization</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._afterInitialization._afterInitialization" id="apidoc.element.bpmn.ProcessManager.prototype._afterInitialization._afterInitialization">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_afterInitialization
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_afterInitialization = function (callback){
    if(this._initialized){
        return callback(this._initializationError);
    }

    this._initialiseCallbacks.push(callback);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
 * @param {String} processId
 * @param {Function} callback
 */
ProcessManager.prototype.get = function get(processId, callback) {
    var self = this;

    this.<span class="apidocCodeKeywordSpan">_afterInitialization</span>(function(err){
        if(callback){
            callback(err, self._processCache[processId]);
        }
    });
};

/**
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype._createCollaboratingProcesses" id="apidoc.module.bpmn.ProcessManager.prototype._createCollaboratingProcesses">module bpmn.ProcessManager.prototype._createCollaboratingProcesses</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses._createCollaboratingProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._createCollaboratingProcesses._createCollaboratingProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createCollaboratingProcesses
        <span class="apidocSignatureSpan">(processDescriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createCollaboratingProcesses = function (processDescriptors, callback) {
    var self = this;
    var processes = {};

    async.eachSeries(processDescriptors, function(processDescriptor, done) {

        self._createSingleProcess(processDescriptor.id, processDescriptor.name, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDescriptor.name] = bpmnProcess;
            done();
        });

    }, function(err){
        var results = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            results.push(bpmnProcess);
        });

        callback(err, results);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    err = new Error('id already used');
}
            });
            if(err){
return callback(err);
            }

            self.<span class="apidocCodeKeywordSpan">_createCollaboratingProcesses</span>(descriptors, function(err, bpmnProcesses
){
if(err){
    return callback(err);
}

descriptors.forEach(function(descriptor){             // check if one of the ids is already used
    if(self._processCache[descriptor.id]){          // again because a process could have been created in between
        err = new Error('id already used');
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype._createSingleProcess" id="apidoc.module.bpmn.ProcessManager.prototype._createSingleProcess">module bpmn.ProcessManager.prototype._createSingleProcess</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess._createSingleProcess" id="apidoc.element.bpmn.ProcessManager.prototype._createSingleProcess._createSingleProcess">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_createSingleProcess
        <span class="apidocSignatureSpan">(processId, processName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_createSingleProcess = function (processId, processName, callback){
    createBPMNProcess(processId, this._processDefinitions[processName], this._processHandlers[processName], this._persistency, function
(err, bpmnProcess){
        callback(err, bpmnProcess);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
                return;
            }

            self._processDefinitions[currentDefinition.name] = currentDefinition;

            async.each(documents, function(document, done){                                                         // for each
persisted document found

                self.<span class="apidocCodeKeywordSpan">_createSingleProcess</span>(document.processId, currentDefinition.name,
function(err, bpmnProcess){       // create the process
if(err){
    return done(err);
}

if(self._processCache[bpmnProcess.getProcessId()]){                  // check if id already used
    return done(new Error('duplicated id in persisted data'));
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype._getAllProcesses" id="apidoc.module.bpmn.ProcessManager.prototype._getAllProcesses">module bpmn.ProcessManager.prototype._getAllProcesses</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses._getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype._getAllProcesses._getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_getAllProcesses = function (callback) {
    var self = this;
    var allProcessIds = Object.keys(this._processCache);

    if(!callback){
        return;
    }

    callback(null, allProcessIds.map(function(loadedProcessId) {
        return self._processCache[loadedProcessId];
    }));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...


    this._afterInitialization(function(err){
        if (err) {
return callback(err);
        }

        self.<span class="apidocCodeKeywordSpan">_getAllProcesses</span>(function (err, bpmnProcesses) {
if (err) {
    return callback(err);
}

callback(null, bpmnProcesses.map(function (bpmnProcess) {
    return bpmnProcess.processClient;
}));
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype._initialiseDefinition" id="apidoc.module.bpmn.ProcessManager.prototype._initialiseDefinition">module bpmn.ProcessManager.prototype._initialiseDefinition</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition._initialiseDefinition" id="apidoc.element.bpmn.ProcessManager.prototype._initialiseDefinition._initialiseDefinition">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>_initialiseDefinition
        <span class="apidocSignatureSpan">(processDefinition)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">_initialiseDefinition = function (processDefinition){
    var self = this;

    self._initializationError = null;
    self._initialized = false;

    self._definitionsToInitialize.push(processDefinition);

    if(!self._initialising){    // if already initialising we don't call next, the definition will be initialised after current
one.
        next();
    }

    /**
     * Called after all initializations are done.
     * @param err
     */
    function execCallbacks(err){
        self._definitionsToInitialize = [];

        self._initializationError = err;
        self._initialized = true;
        self._initialising = false;

        self._initialiseCallbacks.forEach(function(callback){   // call all waiting callbacks
            callback(err);
        });
    }

    function next(){
        self._initialising = true;

        if(self._definitionsToInitialize.length === 0){     // if all definitions have been initialized
            return execCallbacks();
        }

        var currentDefinition = self._definitionsToInitialize.pop();    // get the next definition

        if(self._processDefinitions[currentDefinition.name] ||      // if the definition already exist it means the processes were
 already loaded
                !self._persistency){                                // if there is no persistency nothing needs to be loaded

            self._processDefinitions[currentDefinition.name] = currentDefinition;   // we simply add or replace the definition
            return next();
        }


        self._persistency.loadAll(currentDefinition.name, function(err, documents){     // load all saved document

            if(err){
                execCallbacks(err);
                return;
            }

            self._processDefinitions[currentDefinition.name] = currentDefinition;

            async.each(documents, function(document, done){                                                         // for each
persisted document found

                self._createSingleProcess(document.processId, currentDefinition.name, function(err, bpmnProcess){       // create
 the process
                    if(err){
                        return done(err);
                    }

                    if(self._processCache[bpmnProcess.getProcessId()]){                  // check if id already used
                        return done(new Error('duplicated id in persisted data'));
                    }

                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    done();
                });

            }, function(err){
                if(err){
                    return execCallbacks(err);
                }

                next();
            });

        });

    }

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

       if(processHandler) {
           self._processHandlers[processDefinition.name] = processHandler;
       } else if(!self._processHandlers[processDefinition.name]){
           throw new Error('No process handler defined for process "'+processDefinition.name+'". The process
 handler must be defined before the process or with the process.');
       }

       self.<span class="apidocCodeKeywordSpan">_initialiseDefinition</span>(processDefinition);
   });
};

/**
* Add a bpmn XML to the manager.
* All process definition found in this file will be initialized and replace the old ones if exists.
* A process handler object or file path can be passed. If none passed the same file path as the bpmn is used or the existing handler
.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.addBpmnFilePath" id="apidoc.module.bpmn.ProcessManager.prototype.addBpmnFilePath">module bpmn.ProcessManager.prototype.addBpmnFilePath</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath.addBpmnFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnFilePath.addBpmnFilePath">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnFilePath
        <span class="apidocSignatureSpan">(bpmnFilePath, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addBpmnFilePath = function (bpmnFilePath, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromFile(processHandler);
    }

    if(!processHandler){
        try{
            processHandler = handlers.getHandlerFromFile(bpmnFilePath);
            processHandler.doneLoadingHandler = self._doneLoadingHandler;
            processHandler.doneSavingHandler = self._doneSavingHandler;
        }catch(err){}
    }

    processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
Managing processes
==================

Process managers are used to create multiple processes using the same definitions and find them back later.

var manager = new bpmn.ProcessManager();

manager.<span class="apidocCodeKeywordSpan">addBpmnFilePath</span>("path/to/myProcess.bpmn");

manager.createProcess("myId", function(err, myProcess){

    // we start the process
    myProcess.triggerEvent("MyStart");

});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.addBpmnXML" id="apidoc.module.bpmn.ProcessManager.prototype.addBpmnXML">module bpmn.ProcessManager.prototype.addBpmnXML</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML.addBpmnXML" id="apidoc.element.bpmn.ProcessManager.prototype.addBpmnXML.addBpmnXML">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addBpmnXML
        <span class="apidocSignatureSpan">(bpmnXml, processName, processHandler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addBpmnXML = function (bpmnXml, processName, processHandler){
    var self = this;
    var processDefinitions;

    if(typeof processHandler === 'string'){
        processHandler = handlers.getHandlerFromString(processHandler);
    }

    processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXml, processName);

    processDefinitions.forEach(function(processDefinition){

        if(processHandler) {
            self._processHandlers[processDefinition.name] = processHandler;
        } else if(!self._processHandlers[processDefinition.name]){
            throw new Error('No process handler defined for process "'+processDefinition.name+'". The process handler must be defined
 before the process or with the process.');
        }

        self._initialiseDefinition(processDefinition);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
   }

   options.bpmnXML.forEach(function(bpmnXML){
       if(!bpmnXML.name || !bpmnXML.xml){
           throw new Error("bpmnXML needs a name and a xml");
       }

       self.<span class="apidocCodeKeywordSpan">addBpmnXML</span>(bpmnXML.xml, bpmnXML.name);
   });
};

/**
* Initialise a new definition by loading all persisted process.
* All other function that need the initialise state will wait until initialization is done.
*
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandler" id="apidoc.module.bpmn.ProcessManager.prototype.addHandler">module bpmn.ProcessManager.prototype.addHandler</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandler.addHandler" id="apidoc.element.bpmn.ProcessManager.prototype.addHandler.addHandler">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandler
        <span class="apidocSignatureSpan">(name, handler)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandler = function (name, handler){
    this._processHandlers[name] = handler;
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

options.handler.forEach(function(handlerDescriptor){
    if(!handlerDescriptor.name || !handlerDescriptor.module){
        throw new Error("handler needs a name and a module");
    }

    self.<span class="apidocCodeKeywordSpan">addHandler</span>(handlerDescriptor.name, handlerDescriptor.module);
});

if(!options.handlerString){
    options.handlerString = [];
}

if(!util.isArray(options.handlerString)){
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandlerFilePath" id="apidoc.module.bpmn.ProcessManager.prototype.addHandlerFilePath">module bpmn.ProcessManager.prototype.addHandlerFilePath</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath.addHandlerFilePath" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerFilePath.addHandlerFilePath">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerFilePath
        <span class="apidocSignatureSpan">(name, handlerFilePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandlerFilePath = function (name, handlerFilePath){
    this._processHandlers[name] = handlers.getHandlerFromFile(handlerFilePath);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

    var manager = new bpmn.ProcessManager({
        bpmnFilePath: "path/to/myProcess.bpmn"
    });



ProcessManager.<span class="apidocCodeKeywordSpan">addHandlerFilePath</span>(name, handlerFilePath)

- **name**: The name of the process definition for which the handler will be used.
- **handlerFilePath**: Path to the javascript file defining the handler module.

ProcessManager.addHandlerString = function(name, handlerString)

- **name**: The name of the process definition for which the handler will be used.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.addHandlerString" id="apidoc.module.bpmn.ProcessManager.prototype.addHandlerString">module bpmn.ProcessManager.prototype.addHandlerString</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.addHandlerString.addHandlerString" id="apidoc.element.bpmn.ProcessManager.prototype.addHandlerString.addHandlerString">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>addHandlerString
        <span class="apidocSignatureSpan">(name, handlerString)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">addHandlerString = function (name, handlerString){
    this._processHandlers[name] = handlers.getHandlerFromString(handlerString);
    this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
    this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
}

options.handlerString.forEach(function(handlerString){
    if(!handlerString.name || !handlerString.string){
        throw new Error("handlerString needs a name and a string");
    }

    self.<span class="apidocCodeKeywordSpan">addHandlerString</span>(handlerString.name, handlerString.string);
});


if(!options.bpmnFilePath){
    options.bpmnFilePath = [];
}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.createProcess" id="apidoc.module.bpmn.ProcessManager.prototype.createProcess">module bpmn.ProcessManager.prototype.createProcess</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createProcess.createProcess" id="apidoc.element.bpmn.ProcessManager.prototype.createProcess.createProcess">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createProcess
        <span class="apidocSignatureSpan">(descriptors, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createProcess = function (descriptors, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(err){
            return callback(err);
        }

        if (typeof descriptors === 'string' &amp;&amp; Object.keys(self._processDefinitions).length !== 1) {
            return callback(new Error("The manager contains more than one process definition. " +
                "processId have to be an Array.&lt;{name: String, id: String}&gt;} "));
        }

        if(util.isArray(descriptors)) {
            descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                if(self._processCache[descriptor.id]){
                    err = new Error('id already used');
                }
            });
            if(err){
                return callback(err);
            }

            self._createCollaboratingProcesses(descriptors, function(err, bpmnProcesses){
                if(err){
                    return callback(err);
                }

                descriptors.forEach(function(descriptor){             // check if one of the ids is already used
                    if(self._processCache[descriptor.id]){          // again because a process could have been created in between
                        err = new Error('id already used');
                    }
                });
                if(err){
                    return callback(err);
                }

                callback(null, bpmnProcesses.map(function(bpmnProcess){
                    self._processCache[bpmnProcess.getProcessId()] = bpmnProcess;
                    return bpmnProcess.processClient;
                }));
            });

            return;
        }

        if(typeof descriptors === 'string') {
            descriptors = {
                id: descriptors,
                name: Object.keys(self._processDefinitions)[0]
            };
        }

        if(self._processCache[descriptors.id]){                                        // check if id already used
            return callback(new Error('id already used'));
        }

        self._createSingleProcess(descriptors.id, descriptors.name, function(err, bpmnProcess){
            if(err){
                return callback(err);
            }

            if(self._processCache[descriptors.id]){                                      // check if id already used
                return callback(new Error('id already used'));                      // again because a process could have been created
 in between
            }

            self._processCache[descriptors.id] = bpmnProcess;
            callback(null, bpmnProcess.processClient);
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Process managers are used to create multiple processes using the same definitions and find them back later.

    var manager = new bpmn.ProcessManager();

    manager.addBpmnFilePath("path/to/myProcess.bpmn");

    manager.<span class="apidocCodeKeywordSpan">createProcess</span>("myId", function(err, myProcess){

        // we start the process
        myProcess.triggerEvent("MyStart");

    });

If the process id is already used an error is returned.
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.createServer" id="apidoc.module.bpmn.ProcessManager.prototype.createServer">module bpmn.ProcessManager.prototype.createServer</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.createServer.createServer" id="apidoc.element.bpmn.ProcessManager.prototype.createServer.createServer">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>createServer
        <span class="apidocSignatureSpan">(options, restifyOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createServer = function (options, restifyOptions){
    return rest.createServer(this,  options, restifyOptions);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Server
------

The above API can also be called by REST HTTP calls. To do this, you have first to instantiate a server from ta manager. For example
:

	// Returns a restify server.
	var server = manager.<span class="apidocCodeKeywordSpan">createServer</span>();
	server.listen(9009, function() {
    	console.log('%s listening at %s', server.name, server.url);
	});

The server is a node restify server. So all features of this package can be used.
The full signature of `createProcess`  is
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByName" id="apidoc.module.bpmn.ProcessManager.prototype.findByName">module bpmn.ProcessManager.prototype.findByName</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByName.findByName" id="apidoc.element.bpmn.ProcessManager.prototype.findByName.findByName">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByName
        <span class="apidocSignatureSpan">(processName, caseSensitive, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByName = function (processName, caseSensitive, callback) {
    var self = this;

    if(typeof caseSensitive === 'function'){
        callback = caseSensitive;
        caseSensitive = true;
    }

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByName(bpmnProcesses, processName, caseSensitive));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
        ...
    });

	// returns all processes using this definition
	bpmn.<span class="apidocCodeKeywordSpan">findByName</span>(definitionName, function(err, processes){
        ...
    });


Persistency
-----------
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByProperty" id="apidoc.module.bpmn.ProcessManager.prototype.findByProperty">module bpmn.ProcessManager.prototype.findByProperty</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByProperty.findByProperty" id="apidoc.element.bpmn.ProcessManager.prototype.findByProperty.findByProperty">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByProperty
        <span class="apidocSignatureSpan">(query, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByProperty = function (query, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByProperty(bpmnProcesses, query));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes
bpmn.getAllProcesses(function(err, processes){
    ...
});

	// returns all processes having the property names
	bpmn.<span class="apidocCodeKeywordSpan">findByProperty</span>({propName1: propValue1, propName2: propValue2, ...}, function(err
, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
    ...
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.findByState" id="apidoc.module.bpmn.ProcessManager.prototype.findByState">module bpmn.ProcessManager.prototype.findByState</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.findByState.findByState" id="apidoc.element.bpmn.ProcessManager.prototype.findByState.findByState">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>findByState
        <span class="apidocSignatureSpan">(stateName, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByState = function (stateName, callback) {
    var self = this;

    if(!callback){
        return;
    }

    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self.getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, find.findByState(bpmnProcesses, stateName));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes having the property names
	bpmn.findByProperty({propName1: propValue1, propName2: propValue2, ...}, function(err, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.<span class="apidocCodeKeywordSpan">findByState</span>(stateName, function(err, processes){
    ...
});

	// returns all processes using this definition
	bpmn.findByName(definitionName, function(err, processes){
    ...
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.get" id="apidoc.module.bpmn.ProcessManager.prototype.get">module bpmn.ProcessManager.prototype.get</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.get.get" id="apidoc.element.bpmn.ProcessManager.prototype.get.get">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>get
        <span class="apidocSignatureSpan">(processId, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function get(processId, callback) {
    var self = this;

    this._afterInitialization(function(err){
        if(callback){
            callback(err, self._processCache[processId]);
        }
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Finding processes
-----------------

Existing processes in a manager can be retrived using these functions:

	// returns the process with the corresponding id
	bpmn.<span class="apidocCodeKeywordSpan">get</span>(processId, function(err, process){
    ...
	});

	// returns all processes
bpmn.getAllProcesses(function(err, processes){
    ...
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.getAllProcesses" id="apidoc.module.bpmn.ProcessManager.prototype.getAllProcesses">module bpmn.ProcessManager.prototype.getAllProcesses</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses.getAllProcesses" id="apidoc.element.bpmn.ProcessManager.prototype.getAllProcesses.getAllProcesses">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getAllProcesses
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getAllProcesses = function (callback) {
    var self = this;

    if(!callback){
        return;
    }


    this._afterInitialization(function(err){
        if (err) {
            return callback(err);
        }

        self._getAllProcesses(function (err, bpmnProcesses) {
            if (err) {
                return callback(err);
            }

            callback(null, bpmnProcesses.map(function (bpmnProcess) {
                return bpmnProcess.processClient;
            }));
        });
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns the process with the corresponding id
	bpmn.get(processId, function(err, process){
    ...
	});

	// returns all processes
bpmn.<span class="apidocCodeKeywordSpan">getAllProcesses</span>(function(err, processes){
    ...
});

	// returns all processes having the property names
	bpmn.findByProperty({propName1: propValue1, propName2: propValue2, ...}, function(err, processes){
    ...
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.ProcessManager.prototype.getDefinitionNames" id="apidoc.module.bpmn.ProcessManager.prototype.getDefinitionNames">module bpmn.ProcessManager.prototype.getDefinitionNames</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames.getDefinitionNames" id="apidoc.element.bpmn.ProcessManager.prototype.getDefinitionNames.getDefinitionNames">
        function <span class="apidocSignatureSpan">bpmn.ProcessManager.prototype.</span>getDefinitionNames
        <span class="apidocSignatureSpan">(callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getDefinitionNames = function (callback){
    var self = this;

    this._afterInitialization(function(err){
        callback(err, Object.keys(self._processDefinitions));
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @param {ProcessManager} manager
 * @param {String} name
 * @param {Function} callback
 * @returns {*}
 */
function getNameWithCase(manager, name, callback){

    manager.<span class="apidocCodeKeywordSpan">getDefinitionNames</span>(function(err, names){
if(err){
    return callback(err);
}

var ret = null;

names.forEach(function(nameWithCase){
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.clearCache" id="apidoc.module.bpmn.clearCache">module bpmn.clearCache</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.clearCache.clearCache" id="apidoc.element.bpmn.clearCache.clearCache">
        function <span class="apidocSignatureSpan">bpmn.</span>clearCache
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearCache = function () {
    definitions.clearCache();
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.client" id="apidoc.module.bpmn.client">module bpmn.client</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.client.BPMNProcessClient" id="apidoc.element.bpmn.client.BPMNProcessClient">
        function <span class="apidocSignatureSpan">bpmn.client.</span>BPMNProcessClient
        <span class="apidocSignatureSpan">(bpmnProcess)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">BPMNProcessClient = function (bpmnProcess) {
    this._implementation = bpmnProcess;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.createUnmanagedCollaboratingProcesses" id="apidoc.module.bpmn.createUnmanagedCollaboratingProcesses">module bpmn.createUnmanagedCollaboratingProcesses</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcesses.createUnmanagedCollaboratingProcesses" id="apidoc.element.bpmn.createUnmanagedCollaboratingProcesses.createUnmanagedCollaboratingProcesses">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcesses
        <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedCollaboratingProcesses = function (bpmnFilePath, callback) {
    var processes = {};
    var processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);
    var handler = handlers.getHandlerFromFile(bpmnFilePath);

    async.eachSeries(processDefinitions, function(processDefinition, done) {
        bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDefinition.name] = bpmnProcess;
            done();
        });
    }, function(err){
        var clients = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            clients.push(bpmnProcess.processClient);
        });

        callback(err, clients);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
BPMN also supports collaborating processes as depicted below.

![](https://raw.githubusercontent.com/e2ebridge/bpmn/master/examples/processes/collaboration.png)

These processes must be created together:

	// create collaborating processes
bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedCollaboratingProcesses</span>("my/collaboration/example.bpmn",
function(err, collaboratingProcesses){

    // start the second process
    var secondProcess = collaboratingProcesses[1];
    secondProcess.triggerEvent("Start Event 2");

});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.createUnmanagedCollaboratingProcessesFromXML" id="apidoc.module.bpmn.createUnmanagedCollaboratingProcessesFromXML">module bpmn.createUnmanagedCollaboratingProcessesFromXML</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML.createUnmanagedCollaboratingProcessesFromXML" id="apidoc.element.bpmn.createUnmanagedCollaboratingProcessesFromXML.createUnmanagedCollaboratingProcessesFromXML">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedCollaboratingProcessesFromXML
        <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedCollaboratingProcessesFromXML = function (bpmnXML, handler, callback) {
    var processes = {};
    var processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXML);

    if(typeof handler === 'string'){
        handler = handlers.getHandlerFromString(handler);
    }

    async.eachSeries(processDefinitions, function(processDefinition, done) {
        bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
            if(err){
                done(err);
            }
            processes[processDefinition.name] = bpmnProcess;
            done();
        });
    }, function(err){
        var clients = [];

        Object.keys(processes).forEach(function(name){
            var bpmnProcess = processes[name];

            var participants = bpmnProcess.getProcessDefinition().getCollaboratingParticipants();

            participants.forEach(function (participant) {
                bpmnProcess.addParticipant(participant.name, processes[participant.name]);
            });

            clients.push(bpmnProcess.processClient);
        });

        callback(err, clients);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.createUnmanagedProcess" id="apidoc.module.bpmn.createUnmanagedProcess">module bpmn.createUnmanagedProcess</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedProcess.createUnmanagedProcess" id="apidoc.element.bpmn.createUnmanagedProcess.createUnmanagedProcess">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcess
        <span class="apidocSignatureSpan">(bpmnFilePath, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedProcess = function (bpmnFilePath, callback) {
    var processDefinition, error;
    var processDefinitions = definitions.getBPMNProcessDefinitions(bpmnFilePath);
    var handler = handlers.getHandlerFromFile(bpmnFilePath);

    if (processDefinitions.length === 1) {
        processDefinition = processDefinitions[0];
    } else {
        error = new Error("The BPMN file '" + bpmnFilePath + "'. contains more than one process definition. Use 'createCollaboratingProcesses
' instead of 'createProcess'");
        if(!callback) {
            throw error;
        } else {
            callback(error);
        }
    }

    bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
        if(!callback){
            return;
        }

        callback(err, bpmnProcess.processClient);
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
![](https://raw.githubusercontent.com/e2ebridge/bpmn/master/examples/processes/task.png)

then this process can be created by


	var bpmn = require("bpmn");
	// We assume there is a myProcess.js besides myProcess.bpmn that contains the handlers
	bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedProcess</span>("path/to/myProcess.bpmn", function(err, myProcess
){

        // we start the process
        myProcess.triggerEvent("MyStart");

	});

The handler file looks like:
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.createUnmanagedProcessFromXML" id="apidoc.module.bpmn.createUnmanagedProcessFromXML">module bpmn.createUnmanagedProcessFromXML</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.createUnmanagedProcessFromXML.createUnmanagedProcessFromXML" id="apidoc.element.bpmn.createUnmanagedProcessFromXML.createUnmanagedProcessFromXML">
        function <span class="apidocSignatureSpan">bpmn.</span>createUnmanagedProcessFromXML
        <span class="apidocSignatureSpan">(bpmnXML, handler, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createUnmanagedProcessFromXML = function (bpmnXML, handler, callback) {
    var processDefinition, error;
    var processDefinitions = definitions.getBPMNDefinitionsFromXML(bpmnXML, "Standalone");

    if (processDefinitions.length === 1) {
        processDefinition = processDefinitions[0];
    } else {
        error = new Error("The BPMN XML contains more than one process definition. Use 'createCollaboratingProcesses' instead of
 'createProcess'");
        return callback(error);
    }

    if(typeof handler === 'string') {
        handler = handlers.getHandlerFromString(handler);
    }

    bpmnProcesses.createBPMNProcess(null, processDefinition, handler, function(err, bpmnProcess){
        callback(err, bpmnProcess.processClient);
    });

}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    	// Called after MyEnd has been reached
    	done(data);
	};

Processes can also be created from an xml string instead of file. In this case the handler can be an object or a javascript string
 that would be parsed.


	bpmn.<span class="apidocCodeKeywordSpan">createUnmanagedProcessFromXML</span>("&lt;definitions ... &lt;/definitions&gt;
;", "exports.MyStart = ...", function(err, myProcess){

        // we start the process
        myProcess.triggerEvent("MyStart");

	});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.debugger" id="apidoc.module.bpmn.debugger">module bpmn.debugger</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.debugger.DebuggerInterface" id="apidoc.element.bpmn.debugger.DebuggerInterface">
        function <span class="apidocSignatureSpan">bpmn.debugger.</span>DebuggerInterface
        <span class="apidocSignatureSpan">(url, fileName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">DebuggerInterface = function (url, fileName) {
    this.fileName = fileName;
    this.url = urls.parse(url);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.debugger.createDebuggerInterface" id="apidoc.element.bpmn.debugger.createDebuggerInterface">
        function <span class="apidocSignatureSpan">bpmn.debugger.</span>createDebuggerInterface
        <span class="apidocSignatureSpan">(node, fileName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createDebuggerInterface = function (node, fileName) {
    return (new DebuggerInterface(parserUtils.getAttributesValue(node, "href"), fileName));
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.debugger.isDebuggerElement" id="apidoc.element.bpmn.debugger.isDebuggerElement">
        function <span class="apidocSignatureSpan">bpmn.debugger.</span>isDebuggerElement
        <span class="apidocSignatureSpan">(node)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">isDebuggerElement = function (node) {
    return (node.uri === 'http://e2e.ch/bpmneditor/debugger' &amp;&amp; node.local === 'position');
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.find" id="apidoc.module.bpmn.find">module bpmn.find</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.find.findByName" id="apidoc.element.bpmn.find.findByName">
        function <span class="apidocSignatureSpan">bpmn.find.</span>findByName
        <span class="apidocSignatureSpan">(bpmnProcesses, processName, caseSensitive)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByName = function (bpmnProcesses, processName, caseSensitive) {
    var foundProcesses = [];

    if (processName) {
        var compare = function(a, b) {
            var result;
            if (caseSensitive === undefined || caseSensitive) {
                result = (a === b);
            } else {
                result = (a.toLowerCase() === b.toLowerCase());
            }
            return result;
        };

        bpmnProcesses.forEach(function(bpmnProcess) {
            var name = bpmnProcess.getProcessDefinition().name;
            if (compare(name, processName)) {
                foundProcesses.push(bpmnProcess.processClient || bpmnProcess);
            }
        });
    }
    return foundProcesses;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
        ...
    });

	// returns all processes using this definition
	bpmn.<span class="apidocCodeKeywordSpan">findByName</span>(definitionName, function(err, processes){
        ...
    });


Persistency
-----------
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.find.findByProperty" id="apidoc.element.bpmn.find.findByProperty">
        function <span class="apidocSignatureSpan">bpmn.find.</span>findByProperty
        <span class="apidocSignatureSpan">(bpmnProcesses, query)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByProperty = function (bpmnProcesses, query) {
    var foundProcesses = [];
    var findAll = !query;

    bpmnProcesses.forEach(function(bpmnProcess) {
        if (findAll || hasMatchingProperties(bpmnProcess.getProperties(), query)) {
            foundProcesses.push(bpmnProcess.processClient || bpmnProcess);
        }
    });
    return foundProcesses;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes
bpmn.getAllProcesses(function(err, processes){
    ...
});

	// returns all processes having the property names
	bpmn.<span class="apidocCodeKeywordSpan">findByProperty</span>({propName1: propValue1, propName2: propValue2, ...}, function(err
, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.findByState(stateName, function(err, processes){
    ...
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.find.findByState" id="apidoc.element.bpmn.find.findByState">
        function <span class="apidocSignatureSpan">bpmn.find.</span>findByState
        <span class="apidocSignatureSpan">(bpmnProcesses, stateName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">findByState = function (bpmnProcesses, stateName) {
    var foundProcesses = [];
    var findAll = !stateName;

    bpmnProcesses.forEach(function(bpmnProcess) {
        if (findAll || bpmnProcess.getState().hasTokens(stateName)) {
            foundProcesses.push(bpmnProcess.processClient || bpmnProcess);
        }
    });
    return foundProcesses;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

	// returns all processes having the property names
	bpmn.findByProperty({propName1: propValue1, propName2: propValue2, ...}, function(err, processes){
    ...
});

	// returns all processes in this state (callActivity, tasks, event, ...)
	bpmn.<span class="apidocCodeKeywordSpan">findByState</span>(stateName, function(err, processes){
    ...
});

	// returns all processes using this definition
	bpmn.findByName(definitionName, function(err, processes){
    ...
});
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.getBPMNDefinitions" id="apidoc.module.bpmn.getBPMNDefinitions">module bpmn.getBPMNDefinitions</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.getBPMNDefinitions.getBPMNDefinitions" id="apidoc.element.bpmn.getBPMNDefinitions.getBPMNDefinitions">
        function <span class="apidocSignatureSpan">bpmn.</span>getBPMNDefinitions
        <span class="apidocSignatureSpan">(bpmnFilePath, cache)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getBPMNDefinitions = function (bpmnFilePath, cache) {
    var bpmnDefinitions = null;
    if (cache) {
        bpmnDefinitions = definitions.getCachedBPMNDefinitions(bpmnFilePath);
    } else {
        bpmnDefinitions = definitions.getBPMNDefinitions(bpmnFilePath);
    }
    return bpmnDefinitions;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.handler" id="apidoc.module.bpmn.handler">module bpmn.handler</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.handler.callHandler" id="apidoc.element.bpmn.handler.callHandler">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>callHandler
        <span class="apidocSignatureSpan">(name, process, data, handlerDoneCallback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">callHandler = function (name, process, data, handlerDoneCallback) {
    var result, handlerType;
    var done = handlerDoneCallback || function() {};
    var eventType = "callHandler";
    var handler = getHandlerFromProcess(name, process);

    if (handler) {
        handlerType = typeof handler;
        if (handlerType === 'function') {
            try {
                result = handler.call(process.processClient, data, done);
            } catch (error) {
                process.logger.error("Error in handler '" + name + "': " + error.toString());
                process.defaultErrorHandler.call(process.processClient, error, done);
            }
        } else if (handlerType === 'object') {
            // hierarchical handler used for mocking up sub process handlers. See test cases for examples
            // To keep going we have to call done()
            done();
        } else {
            process.callDefaultEventHandler(eventType, name, mapName2HandlerName(name),
                                            "Unknown handler type: '" + handlerType + "'", done);
        }
     } else {
        process.callDefaultEventHandler(eventType, name, mapName2HandlerName(name), "No handler found", done);
    }

    return result;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
            trx.processStateEnd(self.processDefinition.name, self.getProcessId(), activityName);
            trx.end();
        }
        self.logger.trace("Calling done() of '" + handlerName + "'.");
        currentProcess._emitTokens(currentFlowObject, data, true);
    };
    self.logger.trace("Calling '" + handlerName + "' for " + ACTIVITY_END_EVENT + " '"
; + activityName + "'.");
    handler.<span class="apidocCodeKeywordSpan">callHandler</span>(handlerName, currentProcess, data, activityEndHandlerIsDone);
} else {
    self.callDefaultEventHandler(ACTIVITY_END_EVENT, activityName, handlerName,
        "Process cannot handle this activity because it is not currently executed.",
        function(){
            if(trx){
                trx.end();
            }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.handler.getHandlerFileName" id="apidoc.element.bpmn.handler.getHandlerFileName">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFileName
        <span class="apidocSignatureSpan">(bpmnFilePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandlerFileName = function (bpmnFilePath) {
    return (fileUtils.removeFileExtension(bpmnFilePath) + ".js");
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.handler.getHandlerFromFile" id="apidoc.element.bpmn.handler.getHandlerFromFile">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromFile
        <span class="apidocSignatureSpan">(bpmnFilePath)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandlerFromFile = function (bpmnFilePath) {
    var handlerFilePath = getHandlerFileName(bpmnFilePath);
    return require(handlerFilePath);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Change the process handler using a file.
*
* @param {String} name Name of the process
* @param {String} handlerFilePath
*/
ProcessManager.prototype.addHandlerFilePath = function(name, handlerFilePath){
   this._processHandlers[name] = handlers.<span class="apidocCodeKeywordSpan">getHandlerFromFile</span>(handlerFilePath);
   this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
   this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
};

/**
* Change the process handler using a string.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.handler.getHandlerFromProcess" id="apidoc.element.bpmn.handler.getHandlerFromProcess">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromProcess
        <span class="apidocSignatureSpan">(name, process)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandlerFromProcess = function (name, process) {
    var handlerName = mapName2HandlerName(name);
    var handler = process.eventHandler[handlerName]; // this works as long as event names are unique
    return handler;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.handler.getHandlerFromString" id="apidoc.element.bpmn.handler.getHandlerFromString">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>getHandlerFromString
        <span class="apidocSignatureSpan">(moduleString)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">getHandlerFromString = function (moduleString) {
    var Module = require('module').Module;
    var handlerModule = new Module();
    handlerModule._compile(stripBOM(moduleString));
    return handlerModule.exports;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
/**
* Change the process handler using a string.
*
* @param {String} name Name of the process
* @param {String} handlerString
*/
ProcessManager.prototype.addHandlerString = function(name, handlerString){
   this._processHandlers[name] = handlers.<span class="apidocCodeKeywordSpan">getHandlerFromString</span>(handlerString);
   this._processHandlers[name].doneLoadingHandler = this._doneLoadingHandler || this._processHandlers[name].doneLoadingHandler;
   this._processHandlers[name].doneSavingHandler = this._doneSavingHandler || this._processHandlers[name].doneSavingHandler;
};

/**
* Change the process handler using an object.
*
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.handler.mapName2HandlerName" id="apidoc.element.bpmn.handler.mapName2HandlerName">
        function <span class="apidocSignatureSpan">bpmn.handler.</span>mapName2HandlerName
        <span class="apidocSignatureSpan">(name)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mapName2HandlerName = function (name) {
    var cleanName = name.replace(/[:!`~\^@*#Â¢Â¬Ã§?Â¦\|&amp;;%@"&lt;&gt;\(\){}\[\]\+, \t\n]/g, "_");

    if (cleanName.match(/^[0-9]/)) {
        cleanName = "_" + cleanName;
    }
    return cleanName;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @private
 */
BPMNProcess.prototype._registerActivityEndEvents = function() {
    var self = this;

    self.on(ACTIVITY_END_EVENT, function(activityName, data) {
var currentToken, owningProcessId, currentProcess, currentFlowObject, activityEndHandlerIsDone;
var handlerName = handler.<span class="apidocCodeKeywordSpan">mapName2HandlerName</span>(activityName) + activityEndHandlerPostfix
;
var trx = self.currentTrx = null;

if(self.transactionLogger){
    trx = self.currentTrx = self.transactionLogger.startTransaction(self.processDefinition.name, 'PSTATE', 'TRANSITION
', null, activityName+'Done');
}

if (self.state.hasTokens(activityName)) {
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.history" id="apidoc.module.bpmn.history">module bpmn.history</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.history.BPMNProcessHistory" id="apidoc.element.bpmn.history.BPMNProcessHistory">
        function <span class="apidocSignatureSpan">bpmn.history.</span>BPMNProcessHistory
        <span class="apidocSignatureSpan">(history)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">BPMNProcessHistory = function (history) {
    /** @type {Array.&lt;HistoryEntry&gt;} */
    this.historyEntries = [];

    if (history) {
        this.historyEntries = history.historyEntries.map(function(historyEntry) {
            var entry = new HistoryEntry(historyEntry.name, historyEntry.type, historyEntry.begin, historyEntry.end);
            if (historyEntry.subhistory) {
                entry.subhistory = new BPMNProcessHistory(historyEntry.subhistory);
            }
            return entry;
        });
        this.createdAt = history.createdAt;
        this.finishedAt = history.finishedAt || null;
    } else {
        this.createdAt = getTimestamp();
        this.finishedAt = null;
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.history.HistoryEntry" id="apidoc.element.bpmn.history.HistoryEntry">
        function <span class="apidocSignatureSpan">bpmn.history.</span>HistoryEntry
        <span class="apidocSignatureSpan">(name, type, begin, end)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">HistoryEntry = function (name, type, begin, end) {
    this.name = name;
    this.type = type;
    this.begin = begin || getTimestamp();
    this.end = end || null;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.history.setDummyTimestampFunction" id="apidoc.element.bpmn.history.setDummyTimestampFunction">
        function <span class="apidocSignatureSpan">bpmn.history.</span>setDummyTimestampFunction
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setDummyTimestampFunction = function () {
    getTimestamp = function () { return "_dummy_ts_"; };
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.history.setTimestampFunction" id="apidoc.element.bpmn.history.setTimestampFunction">
        function <span class="apidocSignatureSpan">bpmn.history.</span>setTimestampFunction
        <span class="apidocSignatureSpan">(getTimestampFunction)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setTimestampFunction = function (getTimestampFunction) {
    getTimestamp = getTimestampFunction;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.logger" id="apidoc.module.bpmn.logger">module bpmn.logger</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.logger.Logger" id="apidoc.element.bpmn.logger.Logger">
        function <span class="apidocSignatureSpan">bpmn.logger.</span>Logger
        <span class="apidocSignatureSpan">(process, options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Logger = function (process, options) {
    this.logLevel = logLevels.error;
    if (options) {
        this.logLevel = getLogLevelValue(options.logLevel || this.logLevel);
    }

    /** {function(string)} */
    this.logAppender = null; // used for example to test log messages

    this.winstonFileTransport = new (winston.transports.File)({
        //level: getLogLevelString(this.logLevel), //TODO: this should work, but it doesn't. Why?
        level: 'verbose',
        filename: './process.log',
        maxsize: 64 * 1024 * 1024,
        maxFiles: 100,
        timestamp: function() {
            return Date.now();
        }
    });
    this.winstonConsoleTransport = new (winston.transports.Console)({
        //level: getLogLevelString(this.logLevel), //TODO: this should work, but it doesn't. Why?
        level: 'verbose',
        colorize: true,
        json: false
    });
    this.winstonLogger = new (winston.Logger)({
        transports: [this.winstonFileTransport, this.winstonConsoleTransport],
        levels: logLevels,
        colors: logLevelColors
    });

    this.setProcess(process);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
this.persistency = persistency;
this.deferredEvents = [];
this.deferEvents = false; // events must be deferred if the process engine is loading or saving state
this.processClient = new BPMNProcessClient(this);
this.participants = {}; // if the process takes part in a collaboration, we store all participant process in this map
this.properties = {}; // TODO: how do we handle parent data?
this.calledProcesses = {};
this.logger = new log.<span class="apidocCodeKeywordSpan">Logger</span>(this, {logLevel: log.logLevels.error});
if(transactionLog) {
    this.transactionLogger = new transactionLog.TransactionLogger();
}
this.currentTrx = null;
this.views = {
    startEvent : null,
    endEvent : null,
...</pre></li>
    </ul>




</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.manager" id="apidoc.module.bpmn.manager">module bpmn.manager</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.manager.ProcessManager" id="apidoc.element.bpmn.manager.ProcessManager">
        function <span class="apidocSignatureSpan">bpmn.manager.</span>ProcessManager
        <span class="apidocSignatureSpan">(options)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ProcessManager = function (options){
    var self = this;

    options = options || {};

    self._processCache = {};

    self._initialized = true;
    self._initialising = false;
    self._initializationError = null;
    self._definitionsToInitialize = [];
    self._initialiseCallbacks = [];

    self._persistency = null;
    if (options.persistencyOptions) {
        self._persistency =  new Persistency(options.persistencyOptions);
        self._doneLoadingHandler = options.persistencyOptions.doneLoading;
        self._doneSavingHandler = options.persistencyOptions.doneSaving;
    }

    self._processHandlers = {};
    self._processDefinitions = {};


    if(!options.handlerFilePath){
        options.handlerFilePath = [];
    }

    if(!util.isArray(options.handlerFilePath)){
        options.handlerFilePath = [options.handlerFilePath];
    }

    options.handlerFilePath.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.filePath){
            throw new Error("handlerFilePath needs a name and a filePath");
        }

        self.addHandlerFilePath(handlerDescriptor.name, handlerDescriptor.filePath);
    });


    if(!options.handler){
        options.handler = [];
    }

    if(!util.isArray(options.handler)){
        options.handler = [options.handler];
    }

    options.handler.forEach(function(handlerDescriptor){
        if(!handlerDescriptor.name || !handlerDescriptor.module){
            throw new Error("handler needs a name and a module");
        }

        self.addHandler(handlerDescriptor.name, handlerDescriptor.module);
    });

    if(!options.handlerString){
        options.handlerString = [];
    }

    if(!util.isArray(options.handlerString)){
        options.handlerString = [options.handlerString];
    }

    options.handlerString.forEach(function(handlerString){
        if(!handlerString.name || !handlerString.string){
            throw new Error("handlerString needs a name and a string");
        }

        self.addHandlerString(handlerString.name, handlerString.string);
    });


    if(!options.bpmnFilePath){
        options.bpmnFilePath = [];
    }

    if(!util.isArray(options.bpmnFilePath)){
        options.bpmnFilePath = [options.bpmnFilePath];
    }

    options.bpmnFilePath.forEach(function(filePath){
        self.addBpmnFilePath(filePath);
    });


    if(!options.bpmnXML){
        options.bpmnXML = [];
    }

    if(!util.isArray(options.bpmnXML)){
        options.bpmnXML = [options.bpmnXML];
    }

    options.bpmnXML.forEach(function(bpmnXML){
        if(!bpmnXML.name || !bpmnXML.xml){
            throw new Error("bpmnXML needs a name and a xml");
        }

        self.addBpmnXML(bpmnXML.xml, bpmnXML.name);
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
	bpmnProcess.removeLogTransport(winston.transports.File);

Managing processes
==================

Process managers are used to create multiple processes using the same definitions and find them back later.

    var manager = new bpmn.<span class="apidocCodeKeywordSpan">ProcessManager</span>();

    manager.addBpmnFilePath("path/to/myProcess.bpmn");

    manager.createProcess("myId", function(err, myProcess){

// we start the process
myProcess.triggerEvent("MyStart");
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.mapName2HandlerName" id="apidoc.module.bpmn.mapName2HandlerName">module bpmn.mapName2HandlerName</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.mapName2HandlerName.mapName2HandlerName" id="apidoc.element.bpmn.mapName2HandlerName.mapName2HandlerName">
        function <span class="apidocSignatureSpan">bpmn.</span>mapName2HandlerName
        <span class="apidocSignatureSpan">(bpmnName)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">mapName2HandlerName = function (bpmnName) {
    return handlers.mapName2HandlerName(bpmnName);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
 * @private
 */
BPMNProcess.prototype._registerActivityEndEvents = function() {
    var self = this;

    self.on(ACTIVITY_END_EVENT, function(activityName, data) {
var currentToken, owningProcessId, currentProcess, currentFlowObject, activityEndHandlerIsDone;
var handlerName = handler.<span class="apidocCodeKeywordSpan">mapName2HandlerName</span>(activityName) + activityEndHandlerPostfix
;
var trx = self.currentTrx = null;

if(self.transactionLogger){
    trx = self.currentTrx = self.transactionLogger.startTransaction(self.processDefinition.name, 'PSTATE', 'TRANSITION
', null, activityName+'Done');
}

if (self.state.hasTokens(activityName)) {
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.process" id="apidoc.module.bpmn.process">module bpmn.process</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.process.createBPMNProcess" id="apidoc.element.bpmn.process.createBPMNProcess">
        function <span class="apidocSignatureSpan">bpmn.process.</span>createBPMNProcess
        <span class="apidocSignatureSpan">(id, processDefinition, eventHandler, persistency, parentProcess, parentToken, parentHistoryEntry, callback)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createBPMNProcess = function (id, processDefinition, eventHandler, persistency, parentProcess, parentToken, parentHistoryEntry, callback) {
    var bpmnProcess;

    if(typeof persistency === 'function' ){
        callback = persistency;
        persistency = null;
        parentProcess = null;
        parentToken = null;
        parentHistoryEntry = null;
    } else if(typeof parentProcess === 'function' ){
        callback = parentProcess;
        parentProcess = null;
        parentToken = null;
        parentHistoryEntry = null;
    } else if(typeof parentToken === 'function' ){
        callback = parentToken;
        parentToken = null;
        parentHistoryEntry = null;
    } else if(typeof parentHistoryEntry === 'function' ){
        callback = parentHistoryEntry;
        parentHistoryEntry = null;
    }

    if(!callback){
        return;
    }

    bpmnProcess = new BPMNProcess(id, processDefinition, eventHandler, persistency, parentProcess, parentToken, parentHistoryEntry
);

    if (bpmnProcess.isMainProcess()) {
        // we save all process information - including called processes - in one document
        bpmnProcess.loadPersistedData(function(err){
            if(callback){
                callback(err, bpmnProcess);
            }
        });
    } else {
        if(callback){
            process.nextTick(function(){        // to stay consistent
                callback(null, bpmnProcess);
            });
        }
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.rest" id="apidoc.module.bpmn.rest">module bpmn.rest</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.rest.clearReceivedMessageIds" id="apidoc.element.bpmn.rest.clearReceivedMessageIds">
        function <span class="apidocSignatureSpan">bpmn.rest.</span>clearReceivedMessageIds
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">clearReceivedMessageIds = function () {
    receivedMessageIds = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.rest.createServer" id="apidoc.element.bpmn.rest.createServer">
        function <span class="apidocSignatureSpan">bpmn.rest.</span>createServer
        <span class="apidocSignatureSpan">(manager, options, restifyOptions)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">createServer = function (manager, options, restifyOptions) {
    var logger, serverOptions, server;
    var settings = options || {};

    settings.createProcessId = settings.createProcessId || uuid.v1;

    logger = new log.Logger(null, settings);
    serverOptions = restifyOptions || {};
    serverOptions.name = serverOptions.name || "BPMNProcessServer";

    // Shimming the log doesn't work as expected: I cannot switch it off for example.
    // Additionally, the log format is horrible. So for the time being we use our own logging
    // serverOptions.log = serverOptions.log || bunyan2winston.createLogger(logger.winstonLogger);

    server = restify.createServer(serverOptions);

    server.use(restify.queryParser({ mapParams: false }));
    server.use(restify.bodyParser({ mapParams: false }));
    server.on('after', function( request, response, route, error) {
        var handler = options.onServerAfterEvent || onServerAfterEvent;
        handler(logger, request, response, route, error);
    });

    server.get(getProcessRoute,
        transactionLog.transactionLoggerMiddleware({
                name: function(req){
                    return 'GET ' + req.params.processName + ' process';
                }
            }),
        function(req, res, next){
            getProcess(manager, req, res, next);
        });
    server.get(getProcessesRoute,
        transactionLog.transactionLoggerMiddleware({
            name: function(req){
                return 'GET ' + req.params.processName + ' processes';
            }
        }),
        function(req, res, next){
            getProcesses(manager, req, res, next);
        });
    server.put(sendMessageRoute,
        transactionLog.transactionLoggerMiddleware({
            name: function(req){
                return 'PUT ' + req.params.messageName + ' message to ' + req.params.processName + ' process';
            }
        }),
        function(req, res, next) {
            sendMessage(manager, logger, req, res, next);
        }
    );

    // TODO: we need to change these routes.  the catch all '/' makes this load order dependent.
    server.post(createAndStartCollaboratingProcessRoute,
      transactionLog.transactionLoggerMiddleware({
        name: function(req) {
          return 'POST create and start collaborating processes';
        }
      }),
      function(req, res, next) {
        createAndStartCollaboratingProcess(manager, settings, logger, req, res, next);
      }
    );

    server.post(createProcessRoute,
        transactionLog.transactionLoggerMiddleware({
            name: function(req){
                return 'POST create ' + req.params.processName + ' process';
            }
        }),
        function(req, res, next) {
            createProcess(manager, settings, logger, req, res, next);
}
    );
    server.post(createAndStartProcessRoute,
        transactionLog.transactionLoggerMiddleware({
            name: function(req){
                return 'POST create and start ' + req.params.processName + ' process';
            }
        }),
        function(req, res, next) {
            createAndStartProcess(manager, settings, logger, req, res, next);
        }
    );

    return server;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

Server
------

The above API can also be called by REST HTTP calls. To do this, you have first to instantiate a server from ta manager. For example
:

	// Returns a restify server.
	var server = manager.<span class="apidocCodeKeywordSpan">createServer</span>();
	server.listen(9009, function() {
    	console.log('%s listening at %s', server.name, server.url);
	});

The server is a node restify server. So all features of this package can be used.
The full signature of `createProcess`  is
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.state" id="apidoc.module.bpmn.state">module bpmn.state</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.state.BPMNProcessState" id="apidoc.element.bpmn.state.BPMNProcessState">
        function <span class="apidocSignatureSpan">bpmn.state.</span>BPMNProcessState
        <span class="apidocSignatureSpan">(state)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">BPMNProcessState = function (state) {
    /** @type {Array.&lt;Token&gt;} */
    this.tokens = state &amp;&amp; state.tokens ? state.tokens : [];
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.state.CallActivityToken" id="apidoc.element.bpmn.state.CallActivityToken">
        function <span class="apidocSignatureSpan">bpmn.state.</span>CallActivityToken
        <span class="apidocSignatureSpan">(flowObjectName, owningProcessId, calledProcessId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">CallActivityToken = function (flowObjectName, owningProcessId, calledProcessId) {
    Token.call(this, flowObjectName, owningProcessId);
    this.substate = null;
    this.calledProcessId = calledProcessId;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.bpmn.state.Token" id="apidoc.element.bpmn.state.Token">
        function <span class="apidocSignatureSpan">bpmn.state.</span>Token
        <span class="apidocSignatureSpan">(flowObjectName, owningProcessId)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">Token = function (flowObjectName, owningProcessId) {
    this.position = flowObjectName;
    this.owningProcessId = owningProcessId;
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.bpmn.timeouts" id="apidoc.module.bpmn.timeouts">module bpmn.timeouts</a></h1>


    <h2>
        <a href="#apidoc.element.bpmn.timeouts.BPMNPendingTimerEvents" id="apidoc.element.bpmn.timeouts.BPMNPendingTimerEvents">
        function <span class="apidocSignatureSpan">bpmn.timeouts.</span>BPMNPendingTimerEvents
        <span class="apidocSignatureSpan">(bpmnProcess)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">BPMNPendingTimerEvents = function (bpmnProcess) {
    /** @type {Array.&lt;Timeout&gt;} */
    this.pendingTimeouts = {};
    this.bpmnProcess = bpmnProcess;
    this.setTimeoutIds = {};
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>